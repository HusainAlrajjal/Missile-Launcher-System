

def gcd(a, b):
    if b == 0:
        return a
    elif a >= b:
        return gcd(b, a % b)
    else:
        return gcd(b, a)


def EEA(a, b):
    # Base source https://www.geeksforgeeks.org/python-program-for-basic-and-extended-euclidean-algorithms-2/
    # Base Case
    if a == 0:
        return b, 0, 1
    gcd, x1, y1 = EEA(b % a, a)
    x = y1 - (b // a) * x1
    y = x1
    return gcd, x, y


def inverseModuleN(a, m):
    inverseModN = EEA(a, m)
    gcd = inverseModN[0]
    if gcd == 1:
        if inverseModN[1] < 0:
            return inverseModN[1] + m
        else:
            return inverseModN[1]
    else:
        '''
        'No multiplicative inverse for ', str(a), 'mod', str(m))
        '''
        return False


def getXmodM_crt(keys):
    '''
    syntax keyList = [(2, 3), (3, 5), (2, 7)]
    '''
    tempXmodM = []
    all_M_multiplied = 1
    x = 0
    # print(keys, '////////////////////////')
    for k in keys:
        all_M_multiplied *= k[1]  # multiplying all M to get BigM
    for key in keys:
        Mi = int(all_M_multiplied // key[1])
        x += key[0] * Mi * int(inverseModuleN(Mi, key[1]))

    # print(x % all_M_multiplied, all_M_multiplied, '---------------')
    return x % all_M_multiplied, all_M_multiplied


def max_coprime(list_of_numbers):
    max_val = 0
    sum_val = 0
    for i in list_of_numbers:
        for j in list_of_numbers:
            if j != i and gcd(i, j) == 1:
                sum_val += 1
        if sum_val > max_val:
            max_val = sum_val
        sum_val = 0

    return max_val


def restircted_max_coprime(n, list_of_numbers):
    max_val = 0
    sum_val = 0
    for i in list_of_numbers:
        for j in list_of_numbers:
            if j != i and gcd(i, j) == 1:
                sum_val += 1

        if sum_val > max_val:
            max_val = sum_val
        if max_val >= n:
            return max_val
        sum_val = 0

    return max_val


# N>>4443282643086905700476766658225773299077259174169685991521047657127147270712007293058381000844744592280131462280367665121878967050047211122978380865618425807381667398232610903333422261496423970065527947538211665626636478820595407506137278871134285737506427208596948671016521009474729927604856127830401367582670489059358250529671600130396961098264537470777922466578992433638211234869982284119929884134513747419494355472792122791439006619857250810751407082611648538416245263849842942963358565830502753876164626632024879973649605348333457397052693170537848874336096217656921333396581175038872373557993953346770573369988961172669153132435961564535321372530718813834602214973824190926164432668436723744366544809426238008483559875371767879092911041778246461582932087674223411511309088112529166782666188288500292308618166834907957704548569288117708335095775900183592760251769471962652089103225108344547389835276837173635296491646106539042520035941326041451739454263854994712281752723232315783370127781773073469882080580374559524847933866433744927647519720818736976460177744944170957631305481618801851767376532174505368237232654321925841004562774389137721558082563990181461721023897760323519886351462020797749762901640456927814132969935010449693824229601079235924586208747474324791207779424715929765975260918324641388286581631713334638367149113038542227424755364895071768736099641197385394832885264697709054421254621568407423312628772281383805744238200804645408352844416192976904075331216023922400956993795528523642039615266983224716521014927425592919168799423793010185514631510131380842040307085156832045022026003515800664866329270118430208592367679390664013527355271469840470764849349937990877977556329535342385457015717773119473693280839114918006491451901573065265673670726285725080740963086488722347596488886434231037878060585637232149615494993138462869936966444967851685966933189993900439460934899637197842051989350154718224422097494131101238714952186976560938953913229833194744382264247375376135459506989356002012083381439631497706759185942923417127474880766102705786169740951004373229668539426965646704734513654955077528575484765026676571061527026552267740518608044071495713883808789359946404151281198901201771191117765139705619850023329454183982466327563084590561049487061445650480134262132120153315749790683995613076558056351037785879139942464000788841769237761238919657784711700126564805145368731562881587665383086340002085266183636418079175260809211221128493359696210822960813579274127944558106252482438653368546900927168971327228057883322338966035580938535667145997424043868037538561638577535579268572510510207256078377555141980331736281296264158099716053284425076820962117492875580963514575190160454597107132660762219331161950556691513167474632412896997626039319002272051651230260545889952145407559789642061858442213536270919113106785835095698244039324203024720284279832779161765994516288271868148916190661852529524869639417164555284873722249661713106158590746490026703492689928078363967947804122360488758474596029504734758614804402761801665106429045309745926617004771677240508332489157314338303727985629628280755737445986316384223199445271713355840676716565443799091860680376583946951553684245023648690954622396013138632233869088511387149294823809615723194322555555974280235162715975851492342539800645944736050912920280631362508691753857938850562317793930887540713370760025706743424554122730711924527324057268150567262256583519563591568894907502080650960834940203131230658184878682236572522232959416437883729373592088797917942796177426638358850239707474895382364895246141337350558512000154430776023536009739864868619981488346291510322956579177072361638311756718637151832730562115444328264308690570047676665822577329907725917416968599152104765712714727071200729305838100084474459228013146228036766512187896705004721112297838086561842580738166739823261090333342226149642397006552794753821166562663647882059540750613727887113428573750642720859694867101652100947472992760485612783040136758267048905935825052967160013039696109826453747077792246657899243363821123486998228411992988413451374741949435547279212279143900661985725081075140708261164853841624526384984294296335856583050275387616462663202487997364960534833345739705269317053784887433609621765692133339658117503887237355799395334677057336998896117266915313243596156453532137253071881383460221497382419092616443266843672374436654480942623800848355987537176787909291104177824646158293208767422341151130908811252916678266618828850029230861816683490795770454856928811770833509577590018359276025176947196265208910322510834454738983527683717363529649164610653904252003594132604145173945426385499471228175272323231578337012778177307346988208058037455952484793386643374492764751972081873697646017774494417095763130548161880185176737653217450536823723265432192584100456277438913772155808256399018146172102389776032351988635146202079774976290164045692781413296993501044969382422960107923592458620874747432479120777942471592976597526091832464138828658163171333463836714911303854222742475536489507176873609964119738539483288526469770905442125462156840742331262877228138380574423820080464540835284441619297690407533121602392240095699379552852364203961526698322471652101492742559291916879942379301018551463151013138084204030708515683204502202600351580066486632927011843020859236767939066401352735527146984047076484934993799087797755632953534238545701571777311947369328083911491800649145190157306526567367072628572508074096308648872234759648888643423103787806058563723214961549499313846286993696644496785168596693318999390043946093489963719784205198935015471822442209749413110123871495218697656093895391322983319474438226424737537613545950698935600201208338143963149770675918594292341712747488076610270578616974095100437322966853942696564670473451365495507752857548476502667657106152702655226774051860804407149571388380878935994640415128119890120177119111776513970561985002332945418398246632756308459056104948706144565048013426213212015331574979068399561307655805635103778587913994246400078884176923776123891965778471170012656480514536873156288158766538308634000208526618363641807917526080921122112849335969621082296081357927412794455810625248243865336854690092716897132722805788332233896603558093853566714599742404386803753856163857753557926857251051020725607837755514198033173628129626415809971605328442507682096211749287558096351457519016045459710713266076221933116195055669151316747463241289699762603931900227205165123026054588995214540755978964206185844221353627091911310678583509569824403932420302472028427983277916176599451628827186814891619066185252952486963941716455528487372224966171310615859074649002670349268992807836396794780412236048875847459602950473475861480440276180166510642904530974592661700477167724050833248915731433830372798562962828075573744598631638422319944527171335584067671656544379909186068037658394695155368424502364869095462239601313863223386908851138714929482380961572319432255555597428023516271597585149234253980064594473605091292028063136250869175385793885056231779393088754071337076002570674342455412273071192452732405726815056726225658351956359156889490750208065096083494020313123065818487868223657252223295941643788372937359208879791794279617742663835885023970747489538236489524614133735055851200015443077602353600973986486861998148834629151032295657917707236163831175671863715183273056211544432826430869057004767666582257732990772591741696859915210476571271472707120072930583810008447445922801314622803676651218789670500472111229783808656184258073816673982326109033334222614964239700655279475382116656266364788205954075061372788711342857375064272085969486710165210094747299276048561278304013675826704890593582505296716001303969610982645374707779224665789924336382112348699822841199298841345137474194943554727921227914390066198572508107514070826116485384162452638498429429633585658305027538761646266320248799736496053483334573970526931705378488743360962176569213333965811750388723735579939533467705733699889611726691531324359615645353213725307188138346022149738241909261644326684367237443665448094262380084835598753717678790929110417782464615829320876742234115113090881125291667826661882885002923086181668349079577045485692881177083350957759001835927602517694719626520891032251083445473898352768371736352964916461065390425200359413260414517394542638549947122817527232323157833701277817730734698820805803745595248479338664337449276475197208187369764601777449441709576313054816188018517673765321745053682372326543219258410045627743891377215580825639901814617210238977603235198863514620207977497629016404569278141329699350104496938242296010792359245862087474743247912077794247159297659752609183246413882865816317133346383671491130385422274247553648950717687360996411973853948328852646977090544212546215684074233126287722813838057442382008046454083528444161929769040753312160239224009569937955285236420396152669832247165210149274255929191687994237930101855146315101313808420403070851568320450220260035158006648663292701184302085923676793906640135273552714698404707648493499379908779775563295353423854570157177731194736932808391149180064914519015730652656736707262857250807409630864887223475964888864342310378780605856372321496154949931384628699369664449678516859669331899939004394609348996371978420519893501547182244220974941311012387149521869765609389539132298331947443822642473753761354595069893560020120833814396314977067591859429234171274748807661027057861697409510043732296685394269656467047345136549550775285754847650266765710615270265522677405186080440714957138838087893599464041512811989012017711911177651397056198500233294541839824663275630845905610494870614456504801342621321201533157497906839956130765580563510377858791399424640007888417692377612389196577847117001265648051453687315628815876653830863400020852661836364180791752608092112211284933596962108229608135792741279445581062524824386533685469009271689713272280578833223389660355809385356671459974240438680375385616385775355792685725105102072560783775551419803317362812962641580997160532844250768209621174928755809635145751901604545971071326607622193311619505566915131674746324128969976260393190022720516512302605458899521454075597896420618584422135362709191131067858350956982440393242030247202842798327791617659945162882718681489161906618525295248696394171645552848737222496617131061585907464900267034926899280783639679478041223604887584745960295047347586148044027618016651064290453097459266170047716772405083324891573143383037279856296282807557374459863163842231994452717133558406767165654437990918606803765839469515536842450236486909546223960131386322338690885113871492948238096157231943225555559742802351627159758514923425398006459447360509129202806313625086917538579388505623177939308875407133707600257067434245541227307119245273240572681505672622565835195635915688949075020806509608349402031312306581848786822365725222329594164378837293735920887979179427961774266383588502397074748953823648952461413373505585120001544307760235360097398648686199814883462915103229565791770723616383117567186371518327305621154443282643086905700476766658225773299077259174169685991521047657127147270712007293058381000844744592280131462280367665121878967050047211122978380865618425807381667398232610903333422261496423970065527947538211665626636478820595407506137278871134285737506427208596948671016521009474729927604856127830401367582670489059358250529671600130396961098264537470777922466578992433638211234869982284119929884134513747419494355472792122791439006619857250810751407082611648538416245263849842942963358565830502753876164626632024879973649605348333457397052693170537848874336096217656921333396581175038872373557993953346770573369988961172669153132435961564535321372530718813834602214973824190926164432668436723744366544809426238008483559875371767879092911041778246461582932087674223411511309088112529166782666188288500292308618166834907957704548569288117708335095775900183592760251769471962652089103225108344547389835276837173635296491646106539042520035941326041451739454263854994712281752723232315783370127781773073469882080580374559524847933866433744927647519720818736976460177744944170957631305481618801851767376532174505368237232654321925841004562774389137721558082563990181461721023897760323519886351462020797749762901640456927814132969935010449693824229601079235924586208747474324791207779424715929765975260918324641388286581631713334638367149113038542227424755364895071768736099641197385394832885264697709054421254621568407423312628772281383805744238200804645408352844416192976904075331216023922400956993795528523642039615266983224716521014927425592919168799423793010185514631510131380842040307085156832045022026003515800664866329270118430208592367679390664013527355271469840470764849349937990877977556329535342385457015717773119473693280839114918006491451901573065265673670726285725080740963086488722347596488886434231037878060585637232149615494993138462869936966444967851685966933189993900439460934899637197842051989350154718224422097494131101238714952186976560938953913229833194744382264247375376135459506989356002012083381439631497706759185942923417127474880766102705786169740951004373229668539426965646704734513654955077528575484765026676571061527026552267740518608044071495713883808789359946404151281198901201771191117765139705619850023329454183982466327563084590561049487061445650480134262132120153315749790683995613076558056351037785879139942464000788841769237761238919657784711700126564805145368731562881587665383086340002085266183636418079175260809211221128493359696210822960813579274127944558106252482438653368546900927168971327228057883322338966035580938535667145997424043868037538561638577535579268572510510207256078377555141980331736281296264158099716053284425076820962117492875580963514575190160454597107132660762219331161950556691513167474632412896997626039319002272051651230260545889952145407559789642061858442213536270919113106785835095698244039324203024720284279832779161765994516288271868148916190661852529524869639417164555284873722249661713106158590746490026703492689928078363967947804122360488758474596029504734758614804402761801665106429045309745926617004771677240508332489157314338303727985629628280755737445986316384223199445271713355840676716565443799091860680376583946951553684245023648690954622396013138632233869088511387149294823809615723194322555555974280235162715975851492342539800645944736050912920280631362508691753857938850562317793930887540713370760025706743424554122730711924527324057268150567262256583519563591568894907502080650960834940203131230658184878682236572522232959416437883729373592088797917942796177426638358850239707474895382364895246141337350558512000154430776023536009739864868619981488346291510322956579177072361638311756718637151832730562115444328264308690570047676665822577329907725917416968599152104765712714727071200729305838100084474459228013146228036766512187896705004721112297838086561842580738166739823261090333342226149642397006552794753821166562663647882059540750613727887113428573750642720859694867101652100947472992760485612783040136758267048905935825052967160013039696109826453747077792246657899243363821123486998228411992988413451374741949435547279212279143900661985725081075140708261164853841624526384984294296335856583050275387616462663202487997364960534833345739705269317053784887433609621765692133339658117503887237355799395334677057336998896117266915313243596156453532137253071881383460221497382419092616443266843672374436654480942623800848355987537176787909291104177824646158293208767422341151130908811252916678266618828850029230861816683490795770454856928811770833509577590018359276025176947196265208910322510834454738983527683717363529649164610653904252003594132604145173945426385499471228175272323231578337012778177307346988208058037455952484793386643374492764751972081873697646017774494417095763130548161880185176737653217450536823723265432192584100456277438913772155808256399018146172102389776032351988635146202079774976290164045692781413296993501044969382422960107923592458620874747432479120777942471592976597526091832464138828658163171333463836714911303854222742475536489507176873609964119738539483288526469770905442125462156840742331262877228138380574423820080464540835284441619297690407533121602392240095699379552852364203961526698322471652101492742559291916879942379301018551463151013138084204030708515683204502202600351580066486632927011843020859236767